version: "3.8"

services:
  mqtt:
    image: eclipse-mosquitto:2
    ports:
      - "1883:1883"

  yaic:
    build: .
    depends_on:
      - mqtt
    env_file:
      - .env
    environment:
      MQTT_HOST: ${MQTT_HOST:-mqtt}
      MQTT_PORT: ${MQTT_PORT:-1883}
      MQTT_TOPIC_IN: ${MQTT_TOPIC_IN:-yaic/in}
      MQTT_TOPIC_OUT: ${MQTT_TOPIC_OUT:-yaic/out}
      QWEN_API_KEY: ${QWEN_API_KEY}
      QWEN_ENDPOINT: ${QWEN_ENDPOINT:-https://dashscope-intl.aliyuncs.com/compatible-mode/v1/chat/completions}
      QWEN_MODEL: ${QWEN_MODEL:-qwen-vl-plus}
      LOG_LEVEL: ${LOG_LEVEL:-INFO}
      YAIC_LANGUAGE: ${YAIC_LANGUAGE:-ru}
